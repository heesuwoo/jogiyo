<!DOCTYPE html>
<html class="back">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name = "viewport" content = "width=device-width", initial-scale = "1">	<!-- 반응형 웹에 사용하는 메타탭(부트스트랩) -->
        <link rel="stylesheet" href="/css/bootstrap.css"> <!-- 스타일시트 참조, 부트스트랩 참조 -->
        <link rel="stylesheet" href="/css/jquery-ui.min.css" />
        <link rel="stylesheet" href="/css/style.css" />

        <title>조기요 - 사장님 사이트</title>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
        <script type="text/javascript" src="/js/jquery-ui.min.js"></script>
        <script type="text/javascript" src="/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/js/drop_menu.js"></script>
    </head>
    <body class="back">
        <nav class ="navbar navbar-default">	<!-- 내비게이션 구현 -->
            <div class = "navbar-header">	<!-- 헤더(로고 영역) -->
                <button type="button" class="navbar-toggle collapsed" data-toggle = "collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded = "false">	<!-- 버튼 -->
                    <span class = "icon-bar"></span>	<!-- 네비게이션 목록 작대기 -->
                    <span class = "icon-bar"></span>	
                    <span class = "icon-bar"></span>
                </button> 
                <a class = "navbar-brand" href="main"> 조기요-사장님 사이트 </a> <!-- brand: 로고 -->
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class ="nav navbar-nav">	<!-- 리스트 -->
                    <li class="active"><a href="javascript:movePage('main')">메인 페이지</a></li>
                    <li><a href="javascript:movePage('orders')">주문접수</a></li>
                    <li><a href="javascript:movePage('management')">매장관리</a></li>	<!-- ## -->
                </ul>
                <ul class ="nav navbar-nav navbar-right">	<!-- 오른쪽 리스트 -->
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> 접속하기 <span class="caret"></span></a> <!-- #: 현재 가르치고 있는 링크가 없다. caret: 하나의 아이콘 같은 것-->
                        <ul class= "dropdown-menu">
                            //- 로그인 여부 확인 후 드롭다운
                        </ul>
                    </li>	
                </ul>
            </div>
        </nav>
    
    <div class="main_box">
        <div class="box_border2" id="box">
        </div>
        
        //- 포스 기능
        <div class="pos">
            <div class="content">
            </div>    
        </div>
    </div>    

    script.

        const reqBody = {
                cookie : getCookie("id")
        }

        const xhr = new XMLHttpRequest()
        xhr.onload = () => {
            const result = JSON.parse(xhr.responseText)

            var table_list = result.table;
            var window_list = result.window;
            var menu_list = []
            //- console.log(menu_title)
            table_draw(table_list);
            window_draw(window_list);
            
            for(var i=0; i<result.menu.length; i++ ){
                var menu_title = result.menu[i].title
                menu_list.push(menu_title)
            }
            menu(menu_list)
            console.log("menu_list: ", menu_list)
            
        }

        xhr.open('POST', '/main')
        xhr.setRequestHeader('Content-Type', 'application/json')
        xhr.send(JSON.stringify(reqBody))
        


        //메뉴 불러오기 메뉴 title 넘겨받음
        function menu(menu_list){
            const pos_position = document.querySelector(".content")

            //- console.log("menu_list.length: ", menu_list.length)
            for(var j = 0; j < menu_list.length; j++){

                var menu_item = document.createElement('div');  //item div생성
                var menu_id = 'menu_' + j;  //menu id 동적생성
                menu_item.id = menu_id; //munu id 부여
                menu_item.className = 'item';

                menu_item.innerHTML = `<h4 style = 'text-align: center; margin-top: 50%'> ${menu_list[j]} </h4>`;
                pos_position.appendChild(menu_item);
            }
        }


        //테이블 불러오기
        function table_draw(table_list){
            
            for(var i = 0; i < table_list.length; i++){
                const container = document.querySelector('#box');
                const containerWidth = container.clientWidth //컨테이너 박스의 x좌표를 가져옴
                const containerHeight = container.clientHeight //컨테이너 박스의 y좌표를 가져옴
                
                var table = document.createElement('div');
                var x_pot = table_list[i].x
                var y_pot = table_list[i].y

                var left = x_pot * containerWidth;
                var top = y_pot * containerHeight;
                
                //- console.log(left , top)
                var t_id = 'table_' + i;
                table.id = t_id;
                table.style.position = "absolute";
                table.style.left = `${left}px`;
                table.style.top = `${top}px`;
                table.style.width="10%";
                table.style.height="14%";
                table.style.backgroundColor="#f2cfa5";
                table.style.border="1px solid black";
                table.innerHTML = `<p> ${t_id} </p>`;

                container.appendChild(table);
            }
        }
        
        //창문 불러오기
        function window_draw(window_list){
            const container = document.querySelector('#box');
            const containerWidth = container.clientWidth //컨테이너 박스의 x좌표를 가져옴
            const containerHeight = container.clientHeight //컨테이너 박스의 y좌표를 가져옴

            
            for(var i = 0; i < window_list.length; i++){
                var window = document.createElement('div');
                var x_pot = window_list[i].x
                var y_pot = window_list[i].y

                var left = x_pot * containerWidth;
                var top = y_pot * containerHeight;
                
                //- console.log(left , top)
                var w_id = 'window_' + i;
                window.id = w_id;
                window.style.position = "absolute";
                window.style.left = `${left}px`;
                window.style.top = `${top}px`;
                window.style.width="10%";
                window.style.height="5%";
                window.style.backgroundColor="#fdfa87";
                window.style.border="1px solid black";
                window.innerHTML = `<p> ${w_id} </p>`;

                container.appendChild(window);
            }
        }

        drop_menu();

    </body>
</html>